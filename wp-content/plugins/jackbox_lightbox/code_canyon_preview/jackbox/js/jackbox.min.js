(function(c){function wb(){E=c(window);fc=c("body");Ya=c("body, html");r=c("<div />").addClass("jackbox-modal");s=c("<div />").addClass("jackbox-holder");da=c("<div />").addClass("jackbox-wrapper");U=c("<div />").addClass("jackbox-preloader");ea=c("<span />").addClass("jackbox-panel jackbox-panel-left");oa=c("<span />").addClass("jackbox-panel jackbox-panel-right");var a=l.createDocumentFragment();a.appendChild(da[0]);a.appendChild(U[0]);r[0].appendChild(a);a=l.createDocumentFragment();a.appendChild(ea[0]); a.appendChild(oa[0]);a.appendChild(s[0]);da[0].appendChild(a);fa=c("<div />").addClass("jackbox-container");pa||(a=c("<span />").addClass("jackbox-pre-outside").appendTo(U),c("<span />").addClass("jackbox-pre-inside").appendTo(a));V*=2;Ka=0;a=l.createDocumentFragment();xb&&(x=c(xb).hide(),a.appendChild(x[0]));a.appendChild(fa[0]);yb&&(y=c(yb).hide(),a.appendChild(y[0]));s[0].appendChild(a);zb=-(B+Aa);qa=[];La=[];F=[];G=[];Ab.each(fd);R&&(c.address.internalChange(Bb),c.address.externalChange(gd)); gc=!0;Ma&&(R?setTimeout(Ma,250):Ma(),Ma=null);Ab=La=xb=yb=qa=null}function fd(){var a=c(this).attr("data-group").split(" ").join("").toLowerCase();if(pa){for(var b=G.length,e=!1;b--;)if(G[b]===a){e=!0;break}e||hc(a)}else-1===G.indexOf(a)&&hc(a)}function hc(a){G[G.length]=a;La=[];c(".jackbox[data-group="+a+"]").each(ic);F[F.length]=La;Za++}function ic(a){isNaN(a)?d=a:(d=c(this).data({id:a,cat:Za}),La[a]=d);if(h=d.attr("href")||d.attr("data-href")){var b;a="#"!==h.charAt(0)?h.toLowerCase().split(".").pop(): "inline";if(b=-1!==h.search("youtube.com")?"youtube":-1!==h.search("vimeo.com")?"vimeo":"mp4"===a?"local":!1){if(d.data("type",b),!d.attr("data-thumbnail"))if("vimeo"===b){var e=d;c.getJSON("http://vimeo.com/api/v2/video/"+h.split("http://vimeo.com/")[1]+".json?callback=?",{format:"json"},function(a){e.attr("data-thumbnail",a[0].thumbnail_small)})}else"youtube"===b&&d.attr("data-thumbnail","http://img.youtube.com/vi/"+h.split("http://www.youtube.com/watch?v=")[1]+"/1.jpg")}else if("jpg"===a||"png"=== a||"jpeg"===a||"gif"===a)d.data("type","image");else switch(a){case "mp3":d.data("type","audio");break;case "swf":d.data("type","swf");break;case "inline":d.data("type","inline");break;default:d.data("type","iframe")}d.on("click.jackbox",hd);if(K=d.attr("data-description")){if(qa)if(a=qa.indexOf(K),-1===a){K=c(K);if(!K.length)return;qa[qa.length]=K}else K=qa[a];else if(K=c(K),!K.length)return;d.data("description",K)}}}function gd(a){if(kc){kc=!1;var b=l.URL.split("?url=");if(2===b.length){window.location= b[0]+"#/"+b[1];return}}clearTimeout(Na);lc(a.value);-1!==C?mc?(mc=!1,Bb()):Na=setTimeout(Bb,750):W&&Cb()}function Bb(a){"object"===typeof a&&(clearTimeout(Na),lc(a.value));-1!==C?nc():W&&Cb()}function lc(a){H&&(!ga&&!Ba)&&t[f].removeClass("jb-thumb-active");"/"!==a?(a=a.split("/"),3===a.length?(f=parseInt(a[2],10)-1,isNaN(f)&&(f=0),ha=a[1]):isNaN(a[1])?(f=0,ha=a[1]):(f=parseInt(a[1],10)-1,ha="/")):(ha="/",f=0);if("/"!==ha)for(a=Za;a--;){if(G[a]===ha){C=a;L=F[C].length;S=1!==L;break}}else C=-1;Ba= !1}function $a(){clearTimeout(oc);oc=setTimeout(ia,100)}function hd(a){a.stopPropagation();a.preventDefault();a=c(this).data();ab(a.cat,a.id,!0)}function ab(a,b,e){clearTimeout(Na);if(!e){if(H)for(e=t.length;e--;)t[e].off("click.jackbox");ea.off(".jackbox");oa.off(".jackbox");Ca&&Da.off("keydown.jackbox");p&&Db&&j.cjSwipe("unbindSwipe")}R?c.address.value(G[a]+"/"+(b+1)):(H&&(!ga&&!Ba)&&t[f].removeClass("jb-thumb-active"),f=b,C=a,L=F[C].length,S=1!==L,nc())}function bb(a){if(a&&(a.stopPropagation(), Oa))return!1;W&&(H&&!ga&&t[f].removeClass("jb-thumb-active"),f<F[C].length-1?f++:f=0,Ba=!0,ab(C,f))}function cb(a){if(a&&(a.stopPropagation(),Oa))return!1;W&&(H&&!ga&&t[f].removeClass("jb-thumb-active"),0<f?f--:f=F[C].length-1,Ba=!0,ab(C,f))}function pc(){for(var a=[r[0],da[0],s[0],fa[0]],b=4;b--;)a[b].removeEventListener("touchstart",z,!1),a[b].removeEventListener("touchmove",z,!1),a[b].removeEventListener("touchend",z,!1)}function nc(){db=F[C];if(d=db[f]){if(p)for(var a=[r[0],da[0],s[0],fa[0]], b=4;b--;)a[b].addEventListener("touchstart",z,!1),a[b].addEventListener("touchmove",z,!1),a[b].addEventListener("touchend",z,!1);h=d.attr("href")||d.attr("data-href");if(W)Oa=!0,qc(),rc();else{W=!0;p||Ya.stop();Ka=E.scrollTop();r.appendTo(fc).one("click.jackbox",Eb);Ea||(sc=r.parents().each(id));if(Ca)Da.on("keydown.jackbox_keyboard",jd);tc||(tc=!0,eb=parseInt(s.css("padding-left"),10)+parseInt(s.css("padding-right"),10),Fa=parseInt(s.css("padding-top"),10)+parseInt(s.css("padding-bottom"),10),Fb= parseInt(ea.css("width"),10)+14,fb=Fa+V,Gb=B+(Aa<<1),gb=parseInt(U.css("margin-top"),10),uc=gb-(Gb>>1),vc=parseInt(s.css("padding-left"),10),wc=parseInt(s.css("padding-top"),10),M=c(".jackbox-fullscreen"),M.length||(M=null),ra=!p&&"safari"!==hb&&("webkitRequestFullScreen"in r[0]||"mozFullScreenEnabled"in l));ja=!Hb&&ib&&S?0:zb;D=E.width();I=E.height();s.css({width:D,height:I,marginLeft:-(D>>1)-vc,marginTop:-(I>>1)-wc});Jacked.fadeIn(r[0],{callback:kd});xc=setTimeout(rc,250);da.on("click.jackbox", yc)}}}function id(){c(this).addClass("jackbox-overflow")}function ld(){c(this).removeClass("jackbox-overflow")}function kd(){Ea||E[0].scrollTo(0,0)}function rc(){H&&(t[f].addClass("jb-thumb-active"),ga?ga=!1:Ib(!1,!0));var a;a=d.attr("data-autoplay")?d.attr("data-autoplay"):zc;a="true"===a||!0===a;var b=d.data("description")||null,e=d.attr("data-title")||"",jc;jb="true"===d.attr("data-scaleUp");kb=b&&"string"!==typeof b?b.html():!1;N=d.data("type");a="true"===a||!0===a;e?(Jb=e,ka=escape(Jb)):(ka= !1,"undefined"!==typeof A&&(A.data("links")&&A.data("links").off(".jackbox"),A.empty()));p&&(Db="image"===N,"inline"!==N&&"iframe"!==N&&l.addEventListener("touchmove",z,!1));"image"!==N&&Ac();568<D?U.css("margin-top",0===ja?uc:gb):U.css("margin-top",gb);da.show();U.addClass("jackbox-spin-preloader");switch(N){case "image":Pa=!0;j=c("<img />").addClass("jackbox-content").one("load.jackbox",Qa).prependTo(fa);p&&(j[0].addEventListener("touchstart",z,!1),j[0].addEventListener("touchmove",z,!1),j[0].addEventListener("touchend", z,!1));j.attr("src",h);break;case "youtube":sa(md.split("{url}").join(h.split("watch?v=")[1]).split("{autoplay}").join(a?1:0));break;case "vimeo":sa(nd.split("{url}").join(h.substring(h.lastIndexOf("/"))).split("{autoplay}").join(a));break;case "local":var b=Kb(),e="true"===d.attr("data-firefoxUsesFlash")?"true":"false",Cc=d.attr("data-flashHasPriority")?d.attr("data-flashHasPriority"):Bc.toString();jc="false"===Cc&&ra&&"firefox"!==hb;b=d.attr("data-poster")?b+d.attr("data-poster"):"false";sa(od+ "?video="+h+"&autoplay="+a+"&flashing="+Cc+"&width="+O+"&height="+P+"&poster="+b+"&firefox="+e,!0);break;case "audio":Kb();sa(pd+"?audio="+h+"&title="+(d.attr("data-audiotitle")?d.attr("data-audiotitle"):ka)+"&autoplay="+a);break;case "swf":Kb();sa(qd+"?swf="+h+"&width="+(k.toString()+"&height="+g.toString()));break;case "inline":a=c(h);a=a.length?a.html():"";j=c("<div />").addClass("jackbox-content jackbox-html").html(a).prependTo(fa);j.css("width",k).find("a").on("click",Dc);d.attr("data-height", j.outerHeight(!0));Ac();Qa();break;default:sa(h,!1,!0)}ra&&(!jc?M.show():M.hide())}function Kb(){if(-1===h.search("http")){var a=l.URL.split("#")[0];"/"!==a[a.length-1]&&(a=a.substring(0,a.lastIndexOf("/")+1));h=a+h;return a}}function rd(a){switch(a.keyCode){case 39:bb();break;case 37:cb();break;case 40:lb();break;case 38:lb()}}function jd(a){27===a.keyCode&&Eb(a)}function sd(){la.css("visibility","hidden")}function td(){q.data("offLeft",q.offset().left)}function Ec(){Ga.css({opacity:0,visibility:"hidden"})} function Fc(a){"object"===typeof a&&a.stopPropagation();u<L-ma&&(u++,mb(!1,!0))}function Gc(a){"object"===typeof a&&a.stopPropagation();0<u&&(u--,mb(!1,!0))}function ud(a){a.stopPropagation();a=c(this).parent();a.addClass("jb-thumb-fadein");p||a.addClass("jb-thumb-hover");a.data("id")===f&&a.addClass("jb-thumb-active")}function Hc(a){a.stopPropagation();if(Oa)return!1;a=c(this).data("id");a!==f&&(H&&t[f].removeClass("jb-thumb-active"),f=a,ga=!0,ab(C,f))}function vd(){Ra?Ic():(E.off(".jackbox"),Ra= !0,l.mozFullScreenEnabled?(l.addEventListener("mozfullscreenchange",nb,!1),r[0].mozRequestFullScreen()):r[0].webkitRequestFullScreen&&(l.addEventListener("webkitfullscreenchange",nb,!1),r[0].webkitRequestFullScreen()))}function nb(){l.webkitIsFullScreen||l.mozFullScreen?ia():Ic(!0)}function Lb(a){l.removeEventListener(a.type,Lb,!1);ia();E.on("resize.jackbox",$a)}function Ic(a){Ra=!1;l.mozFullScreenEnabled?(l.removeEventListener("mozfullscreenchange",nb,!1),a?(ia(),E.on("resize.jackbox",$a)):(l.addEventListener("mozfullscreenchange", Lb,!1),l.mozCancelFullScreen())):r[0].webkitRequestFullScreen&&(l.removeEventListener("webkitfullscreenchange",nb,!1),a?(ia(),E.on("resize.jackbox",$a)):(l.addEventListener("webkitfullscreenchange",Lb,!1),l.webkitCancelFullScreen()))}function Ac(){Pa=!1;O=d.attr("data-width")?parseInt(d.attr("data-width"),10):Jc;P=d.attr("data-height")?parseInt(d.attr("data-height"),10):Kc;jb="true"===d.attr("data-scaleUp");Lc()}function Lc(){ob=O+eb+Fb+V;Mb=P+fb;ia("true")}function qc(){clearTimeout(xc);Jacked.stopTween(s[0]); E.off(".jackbox");p&&l.removeEventListener("touchmove",z,!1);j&&(Jacked.stopTween(j[0]),j.remove(),j=null);pb&&(pb.remove(),pb=null);x&&(Jacked.stopTween(x[0],!0),x.hide());y&&(Jacked.stopTween(y[0],!0),y.hide());v&&(v.removeClass("jb-info-inactive"),Jacked.stopTween(J[0]),J.empty().hide())}function Eb(a){a.stopPropagation();R?c.address.value(""):Cb()}function Cb(){clearTimeout(Na);qc();r.unbind(".jackbox");Ca&&Da.off("keydown.jackbox_keyboard");if(S){Ca&&Da.off("keydown.jackbox");ta&&ta.off(".jackbox"); ua&&ua.off(".jackbox");Sa&&q&&q.off(".jackbox");Jacked.stopTween(oa[0],!0);Jacked.stopTween(ea[0],!0);var a={opacity:0,visibility:"hidden"};oa.off(".jackbox").css(a);ea.off(".jackbox").css(a)}else va&&va.show(),w&&w.show();da.hide().off(".jackbox");U.removeClass("jackbox-spin-preloader");"undefined"!==typeof A&&(A.data("links")&&A.data("links").off(".jackbox"),A.empty());ra&&M.off(".jackbox");wa&&wa.unbind(".jackbox");v&&v.off(".jackbox");if(H){Jacked.stopTween(X[0]);for(X.off(".jackbox").hide();t.length;)a= t[0],Jacked.stopTween(a[0]),a.remove(),t.shift();Y.off(".jackbox").hide();Z.off(".jackbox").hide();p&&q.cjSwipe("unbindSwipe");Jacked.stopTween(Q[0]);Q.empty().css("margin-left",0);w&&(w.off(".jackbox"),w&&(T.hide(),$.show()));H=t=null}Ea||sc.each(ld);Jacked.fadeOut(r[0],{duration:1E3,callback:wd});s.css({marginLeft:xd,marginTop:yd});p&&(pc(),l.removeEventListener("touchmove",z,!1));setTimeout(zd,10);la&&la.css("visibility","hidden");d=W=Ra=ga=Nb=qb=Ba=Ob=Ha=null}function zd(){0!==Ka&&(!Ea&&!p?Ya.animate({scrollTop:Ka}, {duration:300,queue:!1}):Ya.scrollTop(Ka))}function wd(){r.detach()}function Ad(a){!a?bb():cb()}function z(a){a.preventDefault()}function Bd(a,b){if(!W&&"success"===b.toLowerCase()&&a){var e=a.length,d=document.URL;for(d.substring(0,d.lastIndexOf("/"));e--;)c("<img />").attr("src",Mc+"/"+a[e].split("../").join(""))}}function Cd(){var a=c(this),b=a.next("img"),e=b.attr("src");b.length&&(a=c("<img />").attr({width:b.attr("width"),height:b.attr("height")}).data("parent",a).one("load.jackbox",Dd).insertAfter(b), b.remove(),a.attr("src",e))}function Dd(){var a=c(this),b=a.data("parent"),e=parseInt(b.css("width"),10)||b.width(),d=parseInt(b.css("height"),10)||b.height(),b=c("<canvas />").addClass("jackbox-canvas-blur").attr({width:e,height:d}).insertBefore(b),d=Date.now(),e=d+1,d=d+2;a.attr("id",e);b.attr("id",d);StackBlurImage(e,d,29)}function Ed(){var a=c(this);a.parent().data({tip:a,tipWidth:a.width()-27,tipHeight:a.height()+17}).on("mouseenter.jackbox",Fd).on("mouseleave.jackbox",Gd)}function Fd(){var a= c(this),b=a.offset(),e=a.data();e.tipX=b.left;e.tipY=b.top;e.tip.css({opacity:1,visibility:"visible"});a.on("mousemove.jackbox",Nc)}function Gd(){var a=c(this).off("mousemove.jackbox");pa?a.data("tip").css("opacity",0):a.data("tip").css({opacity:0,visibility:"hidden"})}function Dc(a){a.stopImmediatePropagation()}function yc(a){c(a.target).is("a")||(a.stopPropagation(),a.preventDefault())}var m={useThumbs:!0,deepLinking:!0,autoPlayVideo:!1,flashVideoFirst:!1,defaultVideoWidth:960,defaultVideoHeight:540, thumbnailWidth:75,thumbnailHeight:50,useThumbTooltips:!0,preloadGraphics:!0,showInfoByDefault:!1,thumbsStartHidden:!1,showPageScrollbar:!1,useKeyboardControls:!0,fullscreenScalesContent:!0,defaultShareImage:"jackbox/img/default_share.jpg"},V=10,Aa=2,Mc="jackbox",Hd=Mc+"/php/graphics.php",qd="jackbox/modules/jackbox_swf.html",od="jackbox/modules/jackbox_video.html",pd="jackbox/modules/jackbox_audio.html",nd="http://player.vimeo.com/video{url}?title=0&byline=0&portrait=0&autoplay={autoplay}&color=FFFFFF&wmode=transparent", md="http://www.youtube.com/embed/{url}?autoplay={autoplay}&autohide=1&hd=1&iv_load_policy=3&showinfo=0&showsearch=0&wmode=transparent",xb='<div class="jackbox-top clearfix"><div class="jackbox-social"></div><div class="jackbox-top-icons"><span class="jackbox-fullscreen"><span class="jackbox-button jackbox-fs"></span><span class="jackbox-button jackbox-ns"></span></span><span class="jackbox-button jackbox-button-margin jackbox-close"></span></div><div />',yb='<div class="jackbox-bottom clearfix"><div class="jackbox-controls"><span class="jackbox-button jackbox-arrow-left"></span><span class="jackbox-button jackbox-arrow-right"></span></div><div class="jackbox-title-text"><span class="jb-current"></span><span class="jb-divider">/</span><span class="jb-total"></span><span class="jackbox-title-txt"></span></div><div class="jackbox-bottom-icons"><span class="jackbox-button jackbox-info"></span><span class="jackbox-button-margin jackbox-button-thumbs"><span class="jackbox-button jackbox-hide-thumbs"></span><span class="jackbox-button jackbox-show-thumbs"></span></span></div></div>', oc,y,ra,vc,wc,Pb,Gb,rb,zb,Ra,Qb,Oc,Fa,eb,Pc,la,Fb,Rb,Q,q,Sb,Z,x,J,aa,T,$,oa,M,Ka,ea,ka,Y,fa,U,ma,qa,Tb,Jb,Db,Ha,Ga,ja,w,wa,kb,va,Qc,Sa,Rc,xa,Ia,u,da,ya,ua,S,gb,ta,jb,Sc,p,fb,sb,Ta,r,A,d,La,v,Da,l,h,k,E,L,Tc,G,g,ha,F,pa,za,Ub,xc,Ma,t,fc,s,Ab,O,tb,Na,Uc,j,P,Pa,D,I,ob,Mb,N,sc,hb,ba,K,W,tc,Ya,Ca,ib,Oa,ga,H,yd,Nb,db,Ea,R,Ua,pb,X,qb,uc,xd,Vc,Ba,Vb,Ob,zc,ca,gc,B,Bc,Wc,Xc,Hb,Jc,Kc,f=1,C=-1,Za=0,mc=!0,kc=!0,Yc={init:function(a,b){!Vc&&"undefined"!==typeof Jacked&&(b&&c.extend(m,b),ib=m.useThumbs,R=m.deepLinking, Sa=m.useThumbTooltips,zc=m.autoPlayVideo,Ca=m.useKeyboardControls,Ea=m.showPageScrollbar,ca=m.thumbnailWidth,Uc=m.fullscreenScalesContent,B=m.thumbnailHeight,Bc=m.flashVideoFirst,Xc=m.showInfoByDefault,Hb=m.thumbsStartHidden,Wc=m.defaultShareImage,Jc=m.defaultVideoWidth,Kc=m.defaultVideoHeight,l=document,Da=c(document),Vc=!0,ba=ca+Aa,tb=-1!==l.URL.search("file:///"),Jacked.setEngines({ios:!0,safari:!0,opera:!0,firefox:!0}),m.preloadGraphics&&!tb&&c.getJSON(Hd+"?jackbox_path=../img/graphics/",Bd), Ab=a,m=null,pa=Jacked.getIE(),p=Jacked.getMobile(),hb=Jacked.getBrowser(),Tc="ie"===hb,p&&(Ea=!1),"undefined"!==typeof c.address&&R?Tc?(wb(),c.address.update()):c.address.init(wb):(R=!1,wb()),"undefined"!==typeof StackBlurImage&&(!tb&&!pa)&&c(".jackbox-hover-blur").each(Cd),c(".jackbox-tooltip").each(Ed))},frameReady:function(){W&&Qa()},newItem:function(a,b){var e=G.length,c=-1,d;if(b&&"object"===typeof b){var f,g,j;for(f in b)"trigger"!==f&&(g="data-"+f,j=b[f],a.attr(g,j),"group"===f&&(d=j))}else b= null;d||(d=a.attr("data-group"));if(d){for(d=d.split(" ").join("").toLowerCase();e--;)if(G[e]===d){c=e;break}if(-1<c){d=F[c];for(var k in d)if(d[k[0]][0]===a[0])return;e=d.length;d[e]=a}else c=G.length,e=F.length,G[c]=d,Za++,F[e]=[a],e=0;ic(a);a.data({id:e,cat:c});b&&b.trigger&&a.trigger("click")}}},sa,ub={type:"text/html",frameborder:0,mozallowfullscreen:"mozallowfullscreen",webkitallowfullscreen:"webkitallowfullscreen",allowfullscreen:"allowfullscreen"};sa=function(a,b,e){ub.width=k;ub.height=g; ub.scrolling=!e?"no":"auto";j=c("<iframe />").attr(ub).addClass("jackbox-content").prependTo(fa);if(!b)j.one("load.jackbox",Qa);j.attr("src",a)};var Qa,Wb={};Qa=function(a){a&&a.stopPropagation();Pa&&(O=this.width||j.width(),P=this.height||j.height(),Lc());Wb.width=k;Wb.height=g;j.css(Wb);Xb(!0);Qb&&Qb();E.on("resize.jackbox",$a)};var Xb,na={},Ja={},Va={};Xb=function(a){if(a){260>k&&(za+=260-k);a=Math.max(k,260);if(a===Ha&&g===Tb){Yb();return}na.callback=Yb;na.duration=Ha?50<Math.abs(a-Ha)||50<Math.abs(g- Tb)?600:300:600}else a=k,Va.width=a,na.duration=300,delete na.callback,x&&Jacked.tween(x[0],Va,na),y&&Jacked.tween(y[0],Va,na),Va.height=g,Jacked.stopTween(j[0],!0),Jacked.tween(j[0],Va,na);Ja.marginLeft=-((za>>1)+0.5|0);Ja.marginTop=-((Ub>>1)+0.5|0);Ja.height=g;Ja.width=a;Ha||(Ja.opacity=1);Jacked.tween(s[0],Ja,na);Ha=a;Tb=g};var Yb,Wa={},Zc={opacity:1,visibility:"visible"};Yb=function(){$c();U.removeClass("jackbox-spin-preloader");var a=Math.max(k,260);Wa.duration=600;Pa&&!pa?Jacked.fadeIn(j[0], Wa):(j.show(),("audio"===N||"local"===N)&&j[0].contentWindow.cjInit());Wa.duration=300;pa?(x&&x.css("width",a).show(),y&&y.css("width",a).show()):(x&&(x.css("width",a),Jacked.fadeIn(x[0],Wa)),y&&(y.css("width",a),Jacked.fadeIn(y[0],Wa)));v&&kb?(v.show(),J.html(kb).show(),aa=-J.outerHeight(),la.css("height",-aa<g?-aa:g),Xc?(Ia=!0,v.addClass("jb-info-inactive"),J.css({visibility:"visible",marginTop:0})):(Ia=!1,J.css("margin-top",aa))):v&&(v.hide(),J.hide());Oa=!1;!qb&&S&&(ea.css(Zc),oa.css(Zc));if(!Ob&& ib&&S){var a=F[C],b=[],e=L,d,f,h,n,m;for(Ob=!0;e--;)h=a[e],h.attr("data-thumbnail")?b[e]=!1:(d=h.children("img"),d.length?(h.attr("data-thumbnail",d.attr("src")),b[e]=d):("image"===h.data("type")?h.attr("data-thumbnail",h.attr("href")||h.attr("data-href")):h.attr("data-thumbnail","jackbox/img/thumbs/default.jpg"),b[e]=!1));t=[];X||(e=l.createDocumentFragment(),h=B>>1,X=c("<div />").addClass("jackbox-thumb-holder").css("height",B).appendTo(r),q=c("<div />").addClass("jackbox-thumb-panel").css("height", B),Z=c("<div />").addClass("jackbox-thumb-right"),Y=c("<div />").addClass("jackbox-thumb-left"),e.appendChild(q[0]),e.appendChild(Z[0]),e.appendChild(Y[0]),q[0].cjThumbs=!0,X[0].appendChild(e),Q=c("<div />").addClass("jackbox-thumb-strip").appendTo(q),Y.css("top",h),Z.css("top",h));h=l.createDocumentFragment();for(e=0;e<L;e++){f=t[e]=c("<div />").data("id",e).addClass("jackbox-thumb").css({width:ca,height:B,left:ba*e}).on("click.jackbox",Hc);if(Sa&&(d=db[e].attr("data-thumbTooltip")||db[e].attr("data-title")))f.data("theTitle", d).on("mouseenter.jackbox",ad).on("mouseleave.jackbox",Ec);h.appendChild(f[0]);d=c("<img />").addClass("jb-thumb").one("load.jackbox",ud).appendTo(f);f.data("theThumb",d);b[e]?(f=b[e].attr("width")||b[e].width(),n=b[e].attr("height")||b[e].height()):(f=ca,n=B);f>ca&&n>B&&(m=f>n?ca/f:B/n,f*=m,n*=m,n<B&&(m=(B-n)/B,f+=f*m,n+=n*m),f<ca&&(m=(ca-f)/ca,f+=f*m,n+=n*m),f!==(f|0)&&(f=f+1|0),n!==(n|0)&&(n=n+1|0));d.attr({width:f,height:n,src:a[e].attr("data-thumbnail")})}Q[0].appendChild(h);Pc=t.length;Sb=ba* e;H=!0;u=0;X.on("click.jackbox",yc).show();Zb();w&&(Hb?($.hide(),T.show(),X.css("bottom",ja)):(T.hide(),$.show(),X.css("bottom",0)),w.on("click.jackbox",lb))}if(!qb){qb=!0;if(ra)M.on("click.jackbox",vd);if(wa)wa.one("click.jackbox",Eb);if(v)v.on("click.jackbox",bd);if(S){if(ua)ua.on("click.jackbox",bb);if(ta)ta.on("click.jackbox",cb);if(Sa&&q)q.on("mouseenter.jackbox",td)}}p&&(j[0].removeEventListener("touchstart",z,!1),j[0].removeEventListener("touchmove",z,!1),j[0].removeEventListener("touchend", z,!1),pc());if(S){if(H)for(a=t.length;a--;)t[a].on("click.jackbox",Hc);ea.on("click.jackbox",cb);oa.on("click.jackbox",bb);if(Ca)Da.on("keydown.jackbox",rd);p&&Db&&j.cjSwipe("touchSwipe",Ad)}};var $c,vb={type:"text/html",frameborder:0,mozallowfullscreen:"mozallowfullscreen",webkitallowfullscreen:"webkitallowfullscreen",allowfullscreen:"allowfullscreen",scrolling:"no"};$c=function(){if(!Qc){Qc=!0;Ta=c(".jb-total");v=c(".jackbox-info");xa=c(".jb-divider");ya=c(".jb-current");wa=c(".jackbox-close"); sb=c(".jackbox-title-text");A=c(".jackbox-title-txt");va=c(".jackbox-controls");ta=c(".jackbox-arrow-left");Ua=c(".jackbox-social");ua=c(".jackbox-arrow-right");w=c(".jackbox-button-thumbs");T=c(".jackbox-show-thumbs");$=c(".jackbox-hide-thumbs");A.length||(A=null);sb.length||(sb=null);ta.length||(ta=null);xa.length||(xa=null);ua.length||(ua=null);va.length||(va=null);wa.length||(wa=null);Ua.length||(Ua=null);if(!ya.length||!Ta.length)ya=null;ra?(c(".jackbox-ns").hide(),M.length||(M=ra=null)):M&& M.hide();ib?w.length&&T.length&&$.length?T.hide():w=T=$=null:(w.hide(),w=T=$=null);v.length?(la=c("<div />").addClass("jackbox-info-text").appendTo(fa).css("visibility","hidden"),J=c("<div />").addClass("jackbox-description-text").appendTo(la)):v=null;Sa&&(Ga=c("<span />").addClass("jackbox-thumb-tip").css("bottom",B),Pb=c("<span />").addClass("jackbox-thumb-tip-text").text("render me").appendTo(Ga),Ga.appendTo(r),Oc=(parseInt(Ga.css("padding-left"),10)<<1)-(Aa<<1))}S||(va&&va.hide(),w&&w.hide()); if(sb){"false"===ka&&(ka=!1);var a=A&&ka,b=a?" -&nbsp;":"";ya&&S?(ya.text(f+1).show(),Ta.html(L+b).show(),xa&&xa.show()):(Ta&&Ta.hide(),ya&&ya.hide(),xa&&xa.hide());a&&(A.html(Jb),a=A.find("a"),a.length&&(a.on("click.jackbox",Dc),A.data("links",a)))}if(Ua&&!tb){var e,a=l.URL.split("#")[0],b=a.length-1;-1!==a.search("/")&&("/"!==a.charAt(b)?(R?e=a+"#/"+ha+"/"+(f+1):e=a,a=a.substring(0,a.lastIndexOf("/"))):(a=a.substring(0,b),R?e=a+"/#/"+ha+"/"+(f+1):e=a));Pa?b=d.attr("href")||d.attr("data-href"):(b= d.children("img"),b=b.length?b.attr("src"):Wc);-1===b.search("http")&&(b="/"!==b.charAt(0)?a+"/"+b:a+b);vb.width=200;vb.height=21;vb.src="jackbox/modules/jackbox_social.php?url="+encodeURIComponent(e)+"&poster="+encodeURIComponent(b)+"&title="+(ka?escape(ka.replace(/(<([^>]+)>)/ig,"")):escape(l.title));pb=c("<iframe />").attr(vb).appendTo(Ua)}};var bd,$b={},ac={duration:300};bd=function(a){a&&a.stopPropagation();Ia?($b.marginTop=aa,ac.callback=sd,v.removeClass("jb-info-inactive")):(v.addClass("jb-info-inactive"), la.css("visibility","visible"),$b.marginTop=0,delete ac.callback);Jacked.tween(J[0],$b,ac);Ia=!Ia};var ad,bc={opacity:1,visibility:"visible"};ad=function(){p&&(clearTimeout(Sc),Sc=setTimeout(Ec,2E3));var a=c(this),b,e,d;Pb.text(a.data("theTitle"));b=parseInt(Pb.css("width"),10);d=q.data("offLeft");a=a.offset().left;e=d+q.width()-b-Oc;bc.width=b;bc.left=a<d?d:a>e?e:a;Ga.css(bc)};var lb,cd={},Id={duration:300};lb=function(a){a&&a.stopPropagation();0===ja?(ja=zb,w&&($.hide(),T.show())):(ja=0,w&&(T.hide(), $.show()));cd.bottom=ja;Jacked.tween(X[0],cd,Id);569>D||(ia("true"),Xb())};var Zb,cc={};Zb=function(a){var b=D-160;Sb<b?(ma=Pc,Vb=!1):(ma=b/ba|0,Vb=!0);rb=ba*ma-Aa;Rb=ma-1;cc.marginLeft=-(rb>>1)-Aa;cc.width=rb;q.css(cc);Q.css("width",Sb);Ib(a)};var Ib,dd={},Jd={duration:300};Ib=function(a,b){if(a)u=f,0!==f&&f+ma>L&&(u=L-ma),Jacked.stopTween(Q[0]),Q.css("left",u*-ba);else{if(0===f)u=0;else if(f>u+Rb)for(;f>u+Rb;)u++;b?(dd.left=u*-ba,Jacked.tween(Q[0],dd,Jd)):(Jacked.stopTween(Q[0]),Q.css("left",u* -ba))}mb(a,!1)};var mb,ed={},Kd={duration:300};mb=function(a,b){Y.off(".jackbox");Z.off(".jackbox");if(Vb)if(p&&q.cjSwipe("unbindSwipe"),u<L-ma?(Z.on("click.jackbox",Fc).show(),p&&q.cjSwipe("touchSwipeLeft",Fc,!0)):Z.hide(),0<u?(Y.on("click.jackbox",Gc).show(),p&&q.cjSwipe("touchSwipeRight",Gc,!0)):Y.hide(),b)ed.left=u*-ba,Jacked.tween(Q[0],ed,Kd);else{if(a||!Nb){var c=q.offset().left;Y.css("left",c);Z.css("left",c+rb);Nb=!0}}else Y.hide(),Z.hide()};var ia,dc={opacity:1},Xa={};ia=function(a){D=E.width(); I=Math.max(E.height(),226);var b=568<D&&0===ja?Gb:0;Rc="audio"!==N&&"inline"!==N?!Ra?jb:jb||Uc:!1;if(ob<D&&Mb+b<I&&!Rc)k=O,g=P;else{k=D/ob;g=I/Mb;var c=k>g?g:k;k=O*c;g=P*c;D>I?g+fb+b>I&&(g=I-Fa-V-b,k=O*(g/P)):k>g?k+ob>D&&(k=D-V,g=P*(k/O)):g+fb+b>I&&(g=I-Fa-V-b,k=O*(g/P));k!==(k|0)&&(k=k+1|0);g!==(g|0)&&(g=g+1|0)}if("inline"===N){var c=D-eb-Fb-V,d=I-Fa-V-b;k=O>c?c:O;g=P<d?P:g}za=k+eb;Ub=g+Fa+b;"true"!==a&&(Jacked.stopTween(s[0],!1,!0),j&&Jacked.stopTween(j[0],!0,!0),260>k&&(za+=260-k),a=Math.max(260, k),dc.width=a,dc.height=g,Xa.marginLeft=-(0.5*za+0.5|0),Xa.marginTop=-(0.5*Ub+0.5|0),Xa.width=a,Xa.height=g,s.css(Xa),j.css(dc),y&&(Jacked.stopTween(y[0]),y.css("width",a)),x&&(Jacked.stopTween(x[0]),x.css("width",a)),v&&kb&&(aa=-J.outerHeight(),la.css("height",-aa<g?-aa:g),Ia||(Jacked.stopTween(J[0],!1,!0),J.css("margin-top",aa))),H&&Zb(!0))};var Nc,ec={};Nc=function(a){var b=c(this).data();ec.left=a.pageX-b.tipX-b.tipWidth;ec.top=a.pageY-b.tipY-b.tipHeight;b.tip.css(ec)};c.fn.jackBox=function(a, b){if(Yc.hasOwnProperty(a))Yc[a](this,b)};c.jackBox={available:function(a){a&&(gc?R?setTimeout(a,250):a():Ma=a)},itemLoaded:function(a){Qb=a}}})(jQuery);function jackboxFrameReady(){jQuery.fn.jackBox("frameReady")};